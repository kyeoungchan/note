# ğŸ’» ë ˆë””ìŠ¤ ì‹œì‘í•˜ê¸°
> linux í™˜ê²½ì—ì„œ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤. 

## âœ… ë ˆë””ìŠ¤ ì„¤ì¹˜í•˜ê¸°

```shell
-- ìµœì‹  ë²„ì „ ë‹¤ìš´ë¡œë“œ
wget https://download.redis.io/redis-stable.tar.gz
```
ë ˆë””ìŠ¤ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•´ì„œëŠ” gcc ë²„ì „ 4.6 ì´ìƒì´ í•„ìš”í•˜ë¯€ë¡œ gccë¥¼ ë¯¸ë¦¬ ì„¤ì¹˜í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
-  **GNU Compiler Collection**ì˜ ì•½ìë¡œ, GNU í”„ë¡œì íŠ¸ì˜ ì¼í™˜ìœ¼ë¡œ ê°œë°œëœ ë¬´ë£Œ ì˜¤í”ˆ ì†ŒìŠ¤ ì»´íŒŒì¼ëŸ¬ ëª¨ìŒì´ë‹¤.

```shell
-- gcc ì„¤ì¹˜
yum install -y gcc

-- ì••ì¶• íŒŒì¼ í•´ì œ í›„ ë¹Œë“œ
tar -xzvf redis-stable.tar.gz
mv redis-stable redis
cd redis
make
```

> `cc: not found` ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.
> ì´ëŸ´ ë•ŒëŠ” C ì»´íŒŒì¼ëŸ¬ê°€ ì„¤ì¹˜ë˜ì–´ìˆì§€ ì•Šì•„ ë°œìƒí•œ ê²ƒì´ë¯€ë¡œ, í•˜ê¸°ì™€ ê°™ì´ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.
> ```shell
> $ sudo apt update
> $ sudo apt install build-essential pkg-config
> ```

<br>

ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ë‚´ì˜ bin ë””ë ‰í„°ë¦¬ì— ì‹¤í–‰ íŒŒì¼ì„ ë³µì‚¬í•˜ê¸° ìœ„í•´ `make install` ì»¤ë§¨ë“œë¥¼ í”„ë¦¬í•„ìŠ¤ ì§€ì •í™” í•¨ê»˜ ìˆ˜í–‰í•˜ì˜€ë‹¤.
```shell
# í”„ë¦¬í”½ìŠ¤ ê²½ë¡œ: /home/{ê³„ì • username}/redis
$ make PREFIX=/home/redis/redis install
```

<br>

ë ˆë””ìŠ¤ í¬ë¥´ê°€ìš´ë“œ(foreground) ëª¨ë“œ(ì‚¬ìš©ìê°€ í˜„ì¬ ê¸°ê¸° í™”ë©´ì—ì„œ ì§ì ‘ ë³´ê³  ìƒí˜¸ì‘ìš©í•˜ëŠ” ìƒíƒœ)ë¡œ ì‹¤í–‰í•˜ê¸°
```shell
$ bin/redis-server redis.conf
```
![redis_foreground_mode.png](../res/redis_foreground_mode.png)


<br>

## âœ… ë ˆë””ìŠ¤ í™˜ê²½ êµ¬ì„±
### ğŸ’¡ Open files í™•ì¸
> ë ˆë””ìŠ¤ì˜ ê¸°ë³¸ maxclients ì„¤ì • ê°’ì€ 10,000ì´ë‹¤.  
ì´ëŠ” ë ˆë””ìŠ¤ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆëŠ” ìµœëŒ€ í´ë¼ì´ì–¸íŠ¸ì˜ ê°œìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.  
í•˜ì§€ë§Œ ì´ ê°’ì€ ë ˆë””ìŠ¤ë¥¼ ì‹¤í–‰í•˜ëŠ” ì„œë²„ì˜ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ìˆ˜ì— ì˜í–¥ì„ ë°›ëŠ”ë‹¤.  
ë ˆë””ìŠ¤ í”„ë¡œì„¸ìŠ¤ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì˜ˆì•½í•œ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ìˆ˜ëŠ” 32ê°œë¡œ, maxclients ê°’ì— 32ë¥¼ ë”í•œ ê°’ë³´ë‹¤ ì„œë²„ì˜ ìµœëŒ€ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ìˆ˜ê°€ ì‘ìœ¼ë©´ ë ˆë””ìŠ¤ëŠ” ì‹¤í–‰ë  ë•Œ ìë™ìœ¼ë¡œ ê·¸ ìˆ˜ì— ë§ê²Œ ì¡°ì •ëœë‹¤. 

> ğŸ¤” íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ë€?  
> ë¦¬ëˆ…ìŠ¤ í˜¹ì€ ìœ ë‹‰ìŠ¤ ê³„ì—´ì˜ ì‹œìŠ¤í…œì—ì„œ í”„ë¡œì„¸ìŠ¤(process)ê°€ íŒŒì¼(file)ì„ ë‹¤ë£° ë•Œ ì‚¬ìš©í•˜ëŠ” ê°œë…ìœ¼ë¡œ, í”„ë¡œì„¸ìŠ¤ì—ì„œ íŠ¹ì • íŒŒì¼ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì¶”ìƒì ì¸ ê°’ì´ë‹¤.  
> íŒŒì¼ ë””ìŠ¤í¬ëŸ½í„°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ 0ì´ ì•„ë‹Œ ì •ìˆ˜ê°’ì„ ê°–ëŠ”ë‹¤.  
> í”íˆ ìœ ë‹‰ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ëª¨ë“  ê²ƒì„ íŒŒì¼ì´ë¼ê³  í•œë‹¤.  
> ì¼ë°˜ì ì¸ ì •ê·œíŒŒì¼ë¶€í„° ë””ë ‰í† ë¦¬, ì†Œì¼“, íŒŒì´í”„, ë¸”ë¡ ë””ë°”ì´ìŠ¤, ì¼€ë¦­í„° ë””ë°”ì´ìŠ¤ ë“± ëª¨ë“  ê°ì²´ë“¤ì„ íŒŒì¼ë¡œ ê´€ë¦¬í•œë‹¤.    
> í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ ì¤‘ì— íŒŒì¼ì„ Opení•˜ë©´ ì»¤ë„ì€ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ì˜ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ìˆ«ì ì¤‘ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê°€ì¥ ì‘ì€ ê°’ì„ í• ë‹¹í•´ì¤€ë‹¤.  
> ê·¸ ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ê°€ ì—´ë ¤ìˆëŠ” íŒŒì¼ì— ì‹œìŠ¤í…œ ì½œì„ ì´ìš©í•´ì„œ ì ‘ê·¼í•  ë•Œ, íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°(FD)ê°’ì„ ì´ìš©í•´ì„œ íŒŒì¼ì„ ì§€ì¹­í•  ìˆ˜ ìˆë‹¤.  
> 
> ì¶œì²˜: [íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°(File Descriptor) ë€ ë¬´ì—‡ì¸ê°€?](https://twofootdog.tistory.com/51)

<br>

```shell
# í˜„ì¬ ì„œë²„ì˜ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ìˆ˜ í™•ì¸
$ ulimit -a | grep open
```

open filesì˜ ê°’ì´ 10,032ë³´ë‹¤ ì‘ë‹¤ë©´ `/etc/security/limits.conf` íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì€ êµ¬ë¬¸ì„ ì¶”ê°€í•œë‹¤.
```text
*               hard    nofile          100000
*               soft    nofile          100000
```

ì„œë²„ ì¬ì ‘ì† í›„ ë‹¤ì‹œ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ìˆ˜ í™•ì¸í•´ë³´ë©´ ì„¤ì •í•œ ê°’ì´ ë°˜ì˜ë¼ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
```shell
$ ulimit -a | grep open
open files                          (-n) 100000
```

<br>

**ì°¸ê³  ìë£Œ**  
[ê°œë°œìë¥¼ ìœ„í•œ ë ˆë””ìŠ¤](https://product.kyobobook.co.kr/detail/S000210785682)