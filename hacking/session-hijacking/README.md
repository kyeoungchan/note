# 세션 하이재킹
## 정의
- 케빈 미트닉이 사용했던 공격 방법의 하나로, TCP의 세션 관리 취약점을 이용한 공격 기법이다.
- 공격자가 두 컴퓨터 간의 유효한 세션을 장악할 때 발생한다.
  - 공격자는 시스템에 침입하여 데이터를 스누핑하기 위해 유효한 세션 ID를 훔친다.
    > 스누핑이란  
  데이터에 무단으로 접근(access)하는 행위.  
  스누핑은 전송 중인 데이터에 접근하는 것뿐만 아니라 다른 사람의 컴퓨터 화면에 띄운 이메일과 같은 정보를 일상적으로 관찰하거나 다른 사람이 입력하는 내용을 보는 것 등을 포함한다.  
  출처: [스누핑 - TTA정보통신용어사전](https://terms.tta.or.kr/dictionary/dictionaryView.do?word_seq=056079-3)
- 공격자가 세션 중간에 두 시스템 간의 TCP 세션을 장악하여 권한을 획득한다.

## 세션 하이재킹이 발생하는 이유
1. 유효하지 않은 세션 ID에 대한 계정 잠금이 없다.
2. 취약한 세션 ID 생성 알고리즘
3. 안전하지 않은 취급
4. 무기한 세션 만료 시간
5. 짧은 세션 ID
6. 일반 텍스트로 전송

## 세션 하이재킹 과정
1. 스니프(Sniff)
    - 중간자(man-in-the-middle, MITM) 공격을 수행한다.
    - 공격받는 컴퓨터와 서버 사이의 자기 자신을 위치시킨다.
   > 스니핑이란  
   > 사전적인 의미로 스니핑(Sniffing)이란 '코를 킁킁거리다', '냄새를 맡다' 등의 뜻을 가리킨다.  
   > 사전적인 의미와 같이 스니핑은 해킹의 한 기법으로서, 네트워크 상에서 자신이 아닌 다른 상대방들의 패킷 교환을 엿듣는 것을 의미합니다.  
   > 출처: [스니핑 공격 설명 - NordVPN](https://nordvpn.com/ko/blog/what-is-sniffing-attack/)
2. 모니터링(Monitor): 서버와 사용자 사이에 흐르는 패킷을 관찰한다.
3. 차단(Break): 공격받는 컴퓨터의 연결을 종료시킨다.
4. 제어(Take Control): 세션을 제어한다.
5. 주입(Injection): 공격받는 컴퓨터의 세션 ID를 사용하여 서버에 새로운 패킷을 주입한다.

## 세션 하이재킹으로부터의 보호 방안
- TCP 세션 하이재킹에 대응을 위해서는 비동기화 상태 탐지, ACK 패킹 비율 모니터링, 특정 세션에서 패킷 유실 및 재전송이 증가되는 것을 감지해야 한다.
- 보안 쉘(SSH)을 사용하여 보안 통신 채널을 생성한다.
- HTTPS 연결을 통해 인증 쿠키를 전달한다.
- 사용자가 세션을 종료할 수 있도록 로그아웃 기능을 구현한다.
- 로그인 성공 후 세션 ID를 생성한다.
- 사용자와 웹 서버 간에 암호화된 데이터를 전달한다.
- 문자열이나 길이가 긴 난수를 세션 키로 사용한다.

출처  
[세션 하이재킹 (Session Hijacking)](https://developer.mozilla.org/ko/docs/Glossary/Session_Hijacking)